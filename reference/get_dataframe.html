<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Download dataverse file as a dataframe — get_dataframe_by_name • dataverse</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Download dataverse file as a dataframe — get_dataframe_by_name"><meta property="og:description" content="Reads in the Dataverse file into the R environment with any
user-specified function, such as read.csv or readr functions.
Use get_dataframe_by_name if you know the name of the datafile and the DOI
of the dataset. Use get_dataframe_by_doi if you know the DOI of the datafile
itself. Use get_dataframe_by_id if you know the numeric ID of the
datafile. For files that are not datasets, the more generic get_file that
downloads the content as a binary is simpler.
The function can read datasets that are unpublished and are still drafts,
as long as the entry has a UNF. See the download vignette for details."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dataverse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/A-introduction.html">1. Introduction to Dataverse</a>
    </li>
    <li>
      <a href="../articles/B-search.html">2. Data Search and Discovery</a>
    </li>
    <li>
      <a href="../articles/C-download.html">3. Data Download</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/iqss/dataverse-client-r/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Download dataverse file as a dataframe</h1>
    <small class="dont-index">Source: <a href="https://github.com/iqss/dataverse-client-r/blob/HEAD/R/get_dataframe.R" class="external-link"><code>R/get_dataframe.R</code></a></small>
    <div class="hidden name"><code>get_dataframe.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Reads in the Dataverse file into the R environment with any
user-specified function, such as <code>read.csv</code> or <code>readr</code> functions.</p>
<p>Use <code>get_dataframe_by_name</code> if you know the name of the datafile and the DOI
of the dataset. Use <code>get_dataframe_by_doi</code> if you know the DOI of the datafile
itself. Use <code>get_dataframe_by_id</code> if you know the numeric ID of the
datafile. For files that are not datasets, the more generic <code>get_file</code> that
downloads the content as a binary is simpler.</p>
<p>The function can read datasets that are unpublished and are still drafts,
as long as the entry has a UNF. See the download vignette for details.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_dataframe_by_name</span><span class="op">(</span></span>
<span>  <span class="va">filename</span>,</span>
<span>  dataset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .f <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  original <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_dataframe_by_id</span><span class="op">(</span><span class="va">fileid</span>, .f <span class="op">=</span> <span class="cn">NULL</span>, original <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_dataframe_by_doi</span><span class="op">(</span><span class="va">filedoi</span>, .f <span class="op">=</span> <span class="cn">NULL</span>, original <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>filename</dt>
<dd><p>The name of the file of interest, with file extension, for example
<code>"roster-bulls-1996.tab"</code>. Can be a vector for multiple files.</p></dd>


<dt>dataset</dt>
<dd><p>A character specifying a persistent identification ID for a dataset,
for example <code>"doi:10.70122/FK2/HXJVJU"</code>. Alternatively, an object of class
“dataverse_dataset” obtained by <code><a href="get_dataverse.html">dataverse_contents()</a></code>.</p></dd>


<dt>.f</dt>
<dd><p>The function to used for reading in the raw dataset. The user
must choose the appropriate function: for example if the target is a .rds
file, then <code>.f</code> should be <code>readRDS</code> or <code><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">readr::read_rds</a></code>. It can be a custom
function defined by the user. See examples for details.</p></dd>


<dt>original</dt>
<dd><p>A logical, whether to read the ingested,
archival version of the datafile if one exists. If <code>TRUE</code>, users should supply
a function to use to read in the original. The archival versions are tab-delimited
<code>.tab</code> files so if <code>original = FALSE</code>, <code>.f</code> is set to <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_tsv</a></code>.</p></dd>


<dt>...</dt>
<dd><p>Arguments passed on to <code><a href="files.html">get_file</a></code></p><dl><dt><code>file</code></dt>
<dd><p>An integer specifying a file identifier; or a vector of integers
specifying file identifiers; or, if used with the prefix <code>"doi:"</code>, a
character with the file-specific DOI; or, if used without the prefix, a
filename accompanied by a dataset DOI in the <code>dataset</code> argument, or an object of
class “dataverse_file” as returned by <code><a href="get_dataset.html">dataset_files</a></code>.
Can be a vector for multiple files.</p></dd>

    <dt><code>format</code></dt>
<dd><p>A character string specifying a file format for download.
by default, this is “original” (the original file format). If <code>NULL</code>,
no query is added, so ingested files are returned in their ingested TSV form.
For tabular datasets, the option “bundle” downloads the bundle
of the original and archival versions, as well as the documentation.
See <a href="https://guides.dataverse.org/en/latest/api/dataaccess.html" class="external-link">https://guides.dataverse.org/en/latest/api/dataaccess.html</a> for details.</p></dd>

    <dt><code>vars</code></dt>
<dd><p>A character vector specifying one or more variable names, used to
extract a subset of the data.</p></dd>

    <dt><code>key</code></dt>
<dd><p>A character string specifying a Dataverse server API key. If one
is not specified, functions calling authenticated API endpoints will fail.
Keys can be specified atomically or globally using
<code>Sys.setenv("DATAVERSE_KEY" = "examplekey")</code>.</p></dd>

    <dt><code>server</code></dt>
<dd><p>A character string specifying a Dataverse server.
Multiple Dataverse installations exist, with <code>"dataverse.harvard.edu"</code> being the
most major. The server can be defined each time within a function, or it can
be set as a default via an environment variable. To set a default, run
<code>Sys.setenv("DATAVERSE_SERVER" = "dataverse.harvard.edu")</code>
or add <code>DATAVERSE_SERVER = "dataverse.harvard.edu</code> in one's <code>.Renviron</code>
file (<code><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">usethis::edit_r_environ()</a></code>), with the appropriate domain as its value.</p></dd>

  
</dl></dd>


<dt>fileid</dt>
<dd><p>A numeric ID internally used for <code>get_file_by_id</code>. Can be a vector for multiple files.</p></dd>


<dt>filedoi</dt>
<dd><p>A DOI for a single file (not the entire dataset), of the form
<code>"10.70122/FK2/PPIAXE/MHDB0O"</code> or <code>"doi:10.70122/FK2/PPIAXE/MHDB0O"</code>.
Can be a vector for multiple files.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A R object that is returned by the default or user-supplied function
<code>.f</code> argument. For example, if <code>.f = readr::read_tsv()</code>, the function will
return a dataframe as read in by <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_tsv()</a></code>. If the file identifier
is a vector, it will return a list where each slot corresponds to elements of the vector.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># 1. For files originally in plain-text (.csv, .tsv), we recommend</span></span></span>
<span class="r-in"><span><span class="co"># retreiving data.frame from dataverse DOI and file name, or the file's DOI.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df_tab</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">get_dataframe_by_name</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filename <span class="op">=</span> <span class="st">"roster-bulls-1996.tab"</span>,</span></span>
<span class="r-in"><span>    dataset  <span class="op">=</span> <span class="st">"doi:10.70122/FK2/HXJVJU"</span>,</span></span>
<span class="r-in"><span>    server   <span class="op">=</span> <span class="st">"demo.dataverse.org"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df_tab</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">get_dataframe_by_doi</span><span class="op">(</span></span></span>
<span class="r-in"><span>    filedoi      <span class="op">=</span> <span class="st">"10.70122/FK2/HXJVJU/SA3Z2V"</span>,</span></span>
<span class="r-in"><span>    server       <span class="op">=</span> <span class="st">"demo.dataverse.org"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2. For files where Dataverse's ingest loses information (Stata .dta, SPSS .sav)</span></span></span>
<span class="r-in"><span><span class="co"># or cannot be ingested (R .rds), we recommend</span></span></span>
<span class="r-in"><span><span class="co"># specifying `original = TRUE` and specifying a read-in function in .f.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Rds files are not ingested so original = TRUE and .f is required.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"readr"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">df_from_rds_original</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">get_dataframe_by_name</span><span class="op">(</span></span></span>
<span class="r-in"><span>      filename   <span class="op">=</span> <span class="st">"nlsw88_rds-export.rds"</span>,</span></span>
<span class="r-in"><span>      dataset    <span class="op">=</span> <span class="st">"doi:10.70122/FK2/PPIAXE"</span>,</span></span>
<span class="r-in"><span>      server     <span class="op">=</span> <span class="st">"demo.dataverse.org"</span>,</span></span>
<span class="r-in"><span>      original   <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      .f         <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="va"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stata dta files lose attributes such as value labels upon ingest so</span></span></span>
<span class="r-in"><span><span class="co"># reading the original version by a Stata reader such as `haven` is recommended.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"haven"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">df_stata_original</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">get_dataframe_by_name</span><span class="op">(</span></span></span>
<span class="r-in"><span>      filename   <span class="op">=</span> <span class="st">"nlsw88.tab"</span>,</span></span>
<span class="r-in"><span>      dataset    <span class="op">=</span> <span class="st">"doi:10.70122/FK2/PPIAXE"</span>,</span></span>
<span class="r-in"><span>      server     <span class="op">=</span> <span class="st">"demo.dataverse.org"</span>,</span></span>
<span class="r-in"><span>      original   <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      .f         <span class="op">=</span> <span class="fu">haven</span><span class="fu">::</span><span class="va"><a href="https://haven.tidyverse.org/reference/read_dta.html" class="external-link">read_dta</a></span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3. RData files are read in by `base::load()` but cannot be assigned to an</span></span></span>
<span class="r-in"><span><span class="co"># object name. The following shows two possible ways to read in such files.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># First, without relying on `get_dataframe_*`, write as a binary file:</span></span></span>
<span class="r-in"><span><span class="va">as_binary</span> <span class="op">&lt;-</span> <span class="fu"><a href="files.html">get_file_by_doi</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> filedoi <span class="op">=</span> <span class="st">"doi:10.70122/FK2/PPIAXE/5VPXKE"</span>,</span></span>
<span class="r-in"><span> server <span class="op">=</span> <span class="st">"demo.dataverse.org"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/readBin.html" class="external-link">writeBin</a></span><span class="op">(</span><span class="va">as_binary</span>, <span class="fu">path</span><span class="op">(</span><span class="va">temp</span>, <span class="st">"county.RData"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu">path</span><span class="op">(</span><span class="va">temp</span>, <span class="st">"county.RData"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If you are certain each RData contains only one object, one could define a</span></span></span>
<span class="r-in"><span><span class="co"># custom function used in https://stackoverflow.com/a/34926943</span></span></span>
<span class="r-in"><span><span class="va">load_object</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">new.env</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">file</span>, envir <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">tmp</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># https://demo.dataverse.org/file.xhtml?persistentId=doi:10.70122/FK2/PPIAXE/X2FC5V</span></span></span>
<span class="r-in"><span><span class="va">as_rda</span> <span class="op">&lt;-</span> <span class="fu">get_dataframe_by_id</span><span class="op">(</span></span></span>
<span class="r-in"><span>  file <span class="op">=</span> <span class="fl">1939003</span>,</span></span>
<span class="r-in"><span>  server <span class="op">=</span> <span class="st">"demo.dataverse.org"</span>,</span></span>
<span class="r-in"><span>  .f <span class="op">=</span> <span class="va">load_object</span>,</span></span>
<span class="r-in"><span>  original <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Shiro Kuriwaki, Will Beasley, Thomas J. Leeper, Philip Durbin, Sebastian Karcher.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

